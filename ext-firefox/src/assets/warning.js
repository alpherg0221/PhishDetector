import{r as i,u as Ft,a as ae,b as Se,c as It,d as Mt,e as wt,f as Pt,g as Ye,h as Ve,i as Et,o as fe,j as X,m as kt,_ as h,k as Xe,l as Je,n as Ot,p as Bt,q as Rt,s as ne,Z as Ht,A as Lt,t as se,v as re,w as Ne,x as At,y as jt,H as Kt,z as ie,B as Wt,C as Ut,D as ze,W as zt,E as $t,F as Zt,G as Gt,I as qt,J as Yt,K as Qe,L as $e,M as Vt,R as Xt,N as Jt,P as Qt,O,Q as et,S as tt,T as eo,U as to,V as he,X as ye,Y as oo,$ as ao,a0 as T,a1 as no,a2 as be,a3 as xe,a4 as so,a5 as ro}from"../../assets/ThemeProvider.js";import{g as io,r as Ze,a as lo,s as Ce,L as de,b as co,d as uo}from"../../assets/utils.js";import{I as Ge,i as po}from"../../assets/index.js";import{u as fo}from"../../assets/useBoolean.js";import{D as Te,P as mo}from"../../assets/PrimaryButton.js";import"../../assets/_commonjsHelpers.js";var pe=function(a){for(var o=a.activeElement;o!=null&&o.shadowRoot;)o=o.shadowRoot.activeElement;return o},qe=function(a){var o=a.target;return o&&o.shadowRoot&&(o=a.composedPath()[0]),o};function De(a){var o=i.useRef(function(){throw new Error("Cannot call an event handler while rendering")});return Ft(function(){o.current=a},[a]),ae(function(){return function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var s=o.current;return s.apply(void 0,t)}})}var vo=function(){var a=ae({});return i.useEffect(function(){return function(){for(var o=0,t=Object.keys(a);o<t.length;o++){var e=t[o];clearTimeout(e)}}},[a]),ae({setTimeout:function(o,t){var e=setTimeout(o,t);return a[e]=1,e},clearTimeout:function(o){delete a[o],clearTimeout(o)}})},ot=function(a){var o=i.useRef(a);o.current=a,i.useEffect(function(){return function(){var t;(t=o.current)===null||t===void 0||t.call(o)}},[])},go="FocusTrapZone",ho={disabled:!1,disableFirstFocus:!1,forceFocusInsideTrap:!0,isClickableOutsideFocusTrap:!1,"data-tabster":'{"uncontrolled": {"completely": true}}'},yo=function(a,o,t){i.useImperativeHandle(a,function(){return{get previouslyFocusedElement(){return o},focus:t}},[t,o])},z=i.forwardRef(function(a,o){var t,e=i.useRef(null),s=i.useRef(null),n=i.useRef(null),d=Se(e,o),r=It(),v=Mt(),m=wt(),D=(t=Pt(!1))!==null&&t!==void 0?t:!0,g=Ye(ho,a),y=ae({hasFocus:!1,focusStackId:Ve("ftz-",g.id)}),N=g.children,S=g.componentRef,l=g.disabled,B=g.disableFirstFocus,C=g.forceFocusInsideTrap,_=g.focusPreviouslyFocusedInnerElement,F=g.firstFocusableSelector,w=g.firstFocusableTarget,R=g.disableRestoreFocus,J=R===void 0?g.ignoreExternalFocusing:R,j=g.isClickableOutsideFocusTrap,I=g.enableAriaHiddenSiblings,$={"aria-hidden":!0,style:{pointerEvents:"none",position:"fixed"},tabIndex:l?-1:0,"data-is-visible":!0,"data-is-focus-trap-zone-bumper":!0},P=i.useCallback(function(u){u!==s.current&&u!==n.current&&Et(u)},[]),H=De(function(){if(e.current){var u=y.previouslyFocusedElementInTrapZone;if(_&&u&&X(e.current,u)){P(u);return}var p=null;if(typeof w=="string")p=e.current.querySelector(w);else if(w)p=w(e.current);else if(F){var b=typeof F=="string"?F:F();p=e.current.querySelector("."+b)}p||(p=Ot(e.current,e.current.firstChild,!1,!1,!1,!0,void 0,void 0,void 0,m)),p&&P(p)}}),Z=function(u){if(!(l||!e.current)){var p=u===y.hasFocus?Bt(e.current,n.current,!0,!1,m):Rt(e.current,s.current,!0,!1,m);p&&(p===s.current||p===n.current?H():p.focus())}},Q=function(u){var p;(p=g.onBlurCapture)===null||p===void 0||p.call(g,u);var b=u.relatedTarget;u.relatedTarget===null&&(b=pe(r)),X(e.current,b)||(y.hasFocus=!1)},ee=function(u){var p;(p=g.onFocusCapture)===null||p===void 0||p.call(g,u),u.target===s.current?Z(!0):u.target===n.current&&Z(!1),y.hasFocus=!0,u.target!==u.currentTarget&&!(u.target===s.current||u.target===n.current)&&(y.previouslyFocusedElementInTrapZone=qe(u.nativeEvent))},G=De(function(u){if(z.focusStack=z.focusStack.filter(function(b){return y.focusStackId!==b}),!!r){var p=r.activeElement;!J&&typeof(u==null?void 0:u.focus)=="function"&&(X(e.current,p)||p===r.body||p.shadowRoot)&&P(u)}}),M=De(function(u){if(!l&&y.focusStackId===z.focusStack.slice(-1)[0]){var p=qe(u);p&&!X(e.current,p)&&(r&&pe(r)===r.body?setTimeout(function(){r&&pe(r)===r.body&&(H(),y.hasFocus=!0)},0):(H(),y.hasFocus=!0),u.preventDefault(),u.stopPropagation())}});return i.useEffect(function(){var u=[];return C&&u.push(fe(v,"focus",M,!0)),j||u.push(fe(v,"click",M,!0)),function(){u.forEach(function(p){return p()})}},[C,j,v]),i.useEffect(function(){if(!(l||!D&&!C||!e.current)){z.focusStack.push(y.focusStackId);var u=g.elementToFocusOnDismiss||pe(r);return!B&&!X(e.current,u)&&H(),function(){return G(u)}}},[C,l]),i.useEffect(function(){if(!l&&I){var u=kt(e.current);return u}},[l,I,e]),ot(function(){delete y.previouslyFocusedElementInTrapZone}),yo(S,y.previouslyFocusedElementInTrapZone,H),i.createElement("div",h({"aria-labelledby":g.ariaLabelledBy},Xe(g,Je),{ref:d,onFocusCapture:ee,onBlurCapture:Q}),i.createElement("div",h({},$,{ref:s})),N,i.createElement("div",h({},$,{ref:n})))});z.displayName=go;z.focusStack=[];var A;(function(a){a[a.normal=0]="normal",a[a.largeHeader=1]="largeHeader",a[a.close=2]="close"})(A||(A={}));var at=Lt.durationValue2,bo={root:"ms-Modal",main:"ms-Dialog-main",scrollableContent:"ms-Modal-scrollableContent",isOpen:"is-open",layer:"ms-Modal-Layer"},xo=function(a){var o,t=a.className,e=a.containerClassName,s=a.scrollableContentClassName,n=a.isOpen,d=a.isVisible,r=a.hasBeenOpened,v=a.modalRectangleTop,m=a.theme,D=a.topOffsetFixed,g=a.isModeless,y=a.layerClassName,N=a.isDefaultDragHandle,S=a.windowInnerHeight,l=m.palette,B=m.effects,C=m.fonts,_=ne(bo,m);return{root:[_.root,C.medium,{backgroundColor:"transparent",position:"fixed",height:"100%",width:"100%",display:"flex",alignItems:"center",justifyContent:"center",opacity:0,pointerEvents:"none",transition:"opacity ".concat(at)},D&&typeof v=="number"&&r&&{alignItems:"flex-start"},n&&_.isOpen,d&&{opacity:1},d&&!g&&{pointerEvents:"auto"},t],main:[_.main,{boxShadow:B.elevation64,borderRadius:B.roundedCorner2,backgroundColor:l.white,boxSizing:"border-box",position:"relative",textAlign:"left",outline:"3px solid transparent",maxHeight:"calc(100% - 32px)",maxWidth:"calc(100% - 32px)",minHeight:"176px",minWidth:"288px",overflowY:"auto",zIndex:g?Ht.Layer:void 0},g&&{pointerEvents:"auto"},D&&typeof v=="number"&&r&&{top:v},N&&{cursor:"move"},e],scrollableContent:[_.scrollableContent,{overflowY:"auto",flexGrow:1,maxHeight:"100vh",selectors:(o={},o["@supports (-webkit-overflow-scrolling: touch)"]={maxHeight:S},o)},s],layer:g&&[y,_.layer,{pointerEvents:"none"}],keyboardMoveIconContainer:{position:"absolute",display:"flex",justifyContent:"center",width:"100%",padding:"3px 0px"},keyboardMoveIcon:{fontSize:C.xLargePlus.fontSize,width:"24px"}}},Co=se(),To=function(a){re(o,a);function o(t){var e=a.call(this,t)||this;Ne(e);var s=e.props.allowTouchBodyScroll,n=s===void 0?!1:s;return e._allowTouchBodyScroll=n,e}return o.prototype.componentDidMount=function(){!this._allowTouchBodyScroll&&At()},o.prototype.componentWillUnmount=function(){!this._allowTouchBodyScroll&&jt()},o.prototype.render=function(){var t=this.props,e=t.isDarkThemed,s=t.className,n=t.theme,d=t.styles,r=Xe(this.props,Je),v=Co(d,{theme:n,className:s,isDark:e});return i.createElement("div",h({},r,{className:v.root}))},o}(i.Component),Do={root:"ms-Overlay",rootDark:"ms-Overlay--dark"},So=function(a){var o,t=a.className,e=a.theme,s=a.isNone,n=a.isDark,d=e.palette,r=ne(Do,e);return{root:[r.root,e.fonts.medium,{backgroundColor:d.whiteTranslucent40,top:0,right:0,bottom:0,left:0,position:"absolute",selectors:(o={},o[Kt]={border:"1px solid WindowText",opacity:0},o)},s&&{visibility:"hidden"},n&&[r.rootDark,{backgroundColor:d.blackTranslucent40}],t]}},No=ie(To,So,void 0,{scope:"Overlay"}),_o=Wt(function(a,o){return{root:Ut(a,o&&{touchAction:"none",selectors:{"& *":{userSelect:"none"}}})}}),oe={touch:{start:"touchstart",move:"touchmove",stop:"touchend"},mouse:{start:"mousedown",move:"mousemove",stop:"mouseup"}},Fo=function(a){re(o,a);function o(t){var e=a.call(this,t)||this;return e._currentEventType=oe.mouse,e._events=[],e._onMouseDown=function(s){var n=i.Children.only(e.props.children).props.onMouseDown;return n&&n(s),e._currentEventType=oe.mouse,e._onDragStart(s)},e._onMouseUp=function(s){var n=i.Children.only(e.props.children).props.onMouseUp;return n&&n(s),e._currentEventType=oe.mouse,e._onDragStop(s)},e._onTouchStart=function(s){var n=i.Children.only(e.props.children).props.onTouchStart;return n&&n(s),e._currentEventType=oe.touch,e._onDragStart(s)},e._onTouchEnd=function(s){var n=i.Children.only(e.props.children).props.onTouchEnd;n&&n(s),e._currentEventType=oe.touch,e._onDragStop(s)},e._onDragStart=function(s){if(typeof s.button=="number"&&s.button!==0)return!1;if(!(e.props.handleSelector&&!e._matchesSelector(s.target,e.props.handleSelector)||e.props.preventDragSelector&&e._matchesSelector(s.target,e.props.preventDragSelector))){e._touchId=e._getTouchId(s);var n=e._getControlPosition(s);if(n!==void 0){var d=e._createDragDataFromPosition(n);e.props.onStart&&e.props.onStart(s,d),e.setState({isDragging:!0,lastPosition:n});var r=ze(e.context);e._events=[fe(r.body,e._currentEventType.move,e._onDrag,!0),fe(r.body,e._currentEventType.stop,e._onDragStop,!0)]}}},e._onDrag=function(s){s.type==="touchmove"&&s.preventDefault();var n=e._getControlPosition(s);if(n){var d=e._createUpdatedDragData(e._createDragDataFromPosition(n)),r=d.position;e.props.onDragChange&&e.props.onDragChange(s,d),e.setState({position:r,lastPosition:n})}},e._onDragStop=function(s){if(e.state.isDragging){var n=e._getControlPosition(s);if(n){var d=e._createDragDataFromPosition(n);e.setState({isDragging:!1,lastPosition:void 0}),e.props.onStop&&e.props.onStop(s,d),e.props.position&&e.setState({position:e.props.position}),e._events.forEach(function(r){return r()})}}},e.state={isDragging:!1,position:e.props.position||{x:0,y:0},lastPosition:void 0},e}return o.prototype.componentDidUpdate=function(t){this.props.position&&(!t.position||this.props.position!==t.position)&&this.setState({position:this.props.position})},o.prototype.componentWillUnmount=function(){this._events.forEach(function(t){return t()})},o.prototype.render=function(){var t=i.Children.only(this.props.children),e=t.props,s=this.props.position,n=this.state,d=n.position,r=n.isDragging,v=d.x,m=d.y;return s&&!r&&(v=s.x,m=s.y),i.cloneElement(t,{style:h(h({},e.style),{transform:"translate(".concat(v,"px, ").concat(m,"px)")}),className:_o(e.className,this.state.isDragging).root,onMouseDown:this._onMouseDown,onMouseUp:this._onMouseUp,onTouchStart:this._onTouchStart,onTouchEnd:this._onTouchEnd})},o.prototype._getControlPosition=function(t){var e=this._getActiveTouch(t);if(!(this._touchId!==void 0&&!e)){var s=e||t;return{x:s.clientX,y:s.clientY}}},o.prototype._getActiveTouch=function(t){return t.targetTouches&&this._findTouchInTouchList(t.targetTouches)||t.changedTouches&&this._findTouchInTouchList(t.changedTouches)},o.prototype._getTouchId=function(t){var e=t.targetTouches&&t.targetTouches[0]||t.changedTouches&&t.changedTouches[0];if(e)return e.identifier},o.prototype._matchesSelector=function(t,e){var s;if(!t||t===((s=ze(this.context))===null||s===void 0?void 0:s.body))return!1;var n=t.matches||t.webkitMatchesSelector||t.msMatchesSelector;return n?n.call(t,e)||this._matchesSelector(t.parentElement,e):!1},o.prototype._findTouchInTouchList=function(t){if(this._touchId!==void 0){for(var e=0;e<t.length;e++)if(t[e].identifier===this._touchId)return t[e]}},o.prototype._createDragDataFromPosition=function(t){var e=this.state.lastPosition;return e===void 0?{delta:{x:0,y:0},lastPosition:t,position:t}:{delta:{x:t.x-e.x,y:t.y-e.y},lastPosition:e,position:t}},o.prototype._createUpdatedDragData=function(t){var e=this.state.position;return{position:{x:e.x+t.delta.x,y:e.y+t.delta.y},delta:t.delta,lastPosition:e}},o.contextType=zt,o}(i.Component),V={x:0,y:0},Io={isOpen:!1,isDarkOverlay:!0,className:"",containerClassName:"",enableAriaHiddenSiblings:!0},Mo=se(),wo=function(a){var o=10;return a.shiftKey?a.ctrlKey||(o=50):a.ctrlKey&&(o=1),o},Po=function(a,o){i.useImperativeHandle(a.componentRef,function(){return{focus:function(){o.current&&o.current.focus()}}},[o])},nt=i.forwardRef(function(a,o){var t,e,s,n,d,r=Ye(Io,a),v=r.allowTouchBodyScroll,m=r.className,D=r.children,g=r.containerClassName,y=r.scrollableContentClassName,N=r.elementToFocusOnDismiss,S=r.firstFocusableSelector,l=r.focusTrapZoneProps,B=r.forceFocusInsideTrap,C=r.disableRestoreFocus,_=C===void 0?r.ignoreExternalFocusing:C,F=r.isBlocking,w=r.isAlert,R=r.isClickableOutsideFocusTrap,J=r.isDarkOverlay,j=r.onDismiss,I=r.layerProps,$=r.overlay,P=r.isOpen,H=r.titleAriaId,Z=r.styles,Q=r.subtitleAriaId,ee=r.theme,G=r.topOffsetFixed,M=r.responsiveMode,u=r.onLayerDidMount,p=r.isModeless,b=r.dragOptions,L=r.onDismissed,me=r.enableAriaHiddenSiblings,le=r.popupProps,lt=i.useRef(null),ce=i.useRef(null),ct=Se(ce,l==null?void 0:l.componentRef),Fe=i.useRef(null),Ie=Se(lt,o),ut=$t(Ie),Me=Ve("ModalFocusTrapZone",l==null?void 0:l.id),K=Zt(),we=vo(),Pe=we.setTimeout,dt=we.clearTimeout,Ee=i.useState(P),ve=Ee[0],ke=Ee[1],Oe=i.useState(P),pt=Oe[0],Be=Oe[1],Re=i.useState(V),He=Re[0],W=Re[1],Le=i.useState(),ft=Le[0],mt=Le[1],Ae=fo(!1),je=Ae[0],Ke=Ae[1],vt=Ke.toggle,q=Ke.setFalse,c=ae(function(){return{onModalCloseTimer:0,allowTouchBodyScroll:v,scrollableContent:null,lastSetCoordinates:V,events:new Gt({})}}),ge=(b||{}).keepInBounds,gt=w??(F&&!p),ht=I===void 0?"":I.className,Y=Mo(Z,{theme:ee,className:m,containerClassName:g,scrollableContentClassName:y,isOpen:P,isVisible:pt,hasBeenOpened:c.hasBeenOpened,modalRectangleTop:ft,topOffsetFixed:G,isModeless:p,layerClassName:ht,windowInnerHeight:K==null?void 0:K.innerHeight,isDefaultDragHandle:b&&!b.dragHandleSelector}),yt=h(h({eventBubblingEnabled:!1},I),{onLayerDidMount:I&&I.onLayerDidMount?I.onLayerDidMount:u,insertFirst:(I==null?void 0:I.insertFirst)||p,className:Y.layer}),bt=i.useCallback(function(x){x?c.allowTouchBodyScroll?qt(x,c.events):Yt(x,c.events):c.events.off(c.scrollableContent),c.scrollableContent=x},[c]),xt=function(){var x=Fe.current,f=x==null?void 0:x.getBoundingClientRect();f&&(G&&mt(f.top),ge&&(c.minPosition={x:-f.left,y:-f.top},c.maxPosition={x:f.left,y:f.top}))},U=i.useCallback(function(x,f){var E=c.minPosition,te=c.maxPosition;return ge&&E&&te&&(f=Math.max(E[x],f),f=Math.min(te[x],f)),f},[ge,c]),We=function(){var x;c.lastSetCoordinates=V,q(),c.isInKeyboardMoveMode=!1,ke(!1),W(V),(x=c.disposeOnKeyUp)===null||x===void 0||x.call(c),L==null||L()},Ct=i.useCallback(function(){q(),c.isInKeyboardMoveMode=!1},[c,q]),Tt=i.useCallback(function(x,f){W(function(E){return{x:U("x",E.x+f.delta.x),y:U("y",E.y+f.delta.y)}})},[U]),Dt=i.useCallback(function(){ce.current&&ce.current.focus()},[]),St=function(){var x=function(f){if(f.altKey&&f.ctrlKey&&f.keyCode===O.space){f.preventDefault(),f.stopPropagation();return}var E=f.altKey||f.keyCode===O.escape;if(je&&E&&q(),c.isInKeyboardMoveMode&&(f.keyCode===O.escape||f.keyCode===O.enter)&&(c.isInKeyboardMoveMode=!1,f.preventDefault(),f.stopPropagation()),c.isInKeyboardMoveMode){var te=!0,ue=wo(f);switch(f.keyCode){case O.escape:W(c.lastSetCoordinates);case O.enter:{c.lastSetCoordinates=V;break}case O.up:{W(function(k){return{x:k.x,y:U("y",k.y-ue)}});break}case O.down:{W(function(k){return{x:k.x,y:U("y",k.y+ue)}});break}case O.left:{W(function(k){return{x:U("x",k.x-ue),y:k.y}});break}case O.right:{W(function(k){return{x:U("x",k.x+ue),y:k.y}});break}default:te=!1}te&&(f.preventDefault(),f.stopPropagation())}};c.lastSetCoordinates=He,q(),c.isInKeyboardMoveMode=!0,c.events.on(K,"keydown",x,!0),c.disposeOnKeyDown=function(){c.events.off(K,"keydown",x,!0),c.disposeOnKeyDown=void 0}},Nt=function(x){var f,E;(f=l==null?void 0:l.onBlur)===null||f===void 0||f.call(l,x),c.lastSetCoordinates=V,c.isInKeyboardMoveMode=!1,(E=c.disposeOnKeyDown)===null||E===void 0||E.call(c)},_t=function(){var x=function(f){f.altKey&&f.ctrlKey&&f.keyCode===O.space&&X(c.scrollableContent,f.target)&&(vt(),f.preventDefault(),f.stopPropagation())};c.disposeOnKeyUp||(c.events.on(K,"keyup",x,!0),c.disposeOnKeyUp=function(){c.events.off(K,"keyup",x,!0),c.disposeOnKeyUp=void 0})};i.useEffect(function(){dt(c.onModalCloseTimer),P&&(requestAnimationFrame(function(){return Pe(xt,0)}),ke(!0),b&&_t(),c.hasBeenOpened=!0,Be(!0)),!P&&ve&&(c.onModalCloseTimer=Pe(We,parseFloat(at)*1e3),Be(!1))},[ve,P]),ot(function(){c.events.dispose()}),Po(r,ce);var Ue=i.createElement(z,h({},l,{id:Me,ref:Fe,componentRef:ct,className:Qe(Y.main,l==null?void 0:l.className),elementToFocusOnDismiss:(t=l==null?void 0:l.elementToFocusOnDismiss)!==null&&t!==void 0?t:N,isClickableOutsideFocusTrap:(e=l==null?void 0:l.isClickableOutsideFocusTrap)!==null&&e!==void 0?e:p||R||!F,disableRestoreFocus:(s=l==null?void 0:l.disableRestoreFocus)!==null&&s!==void 0?s:_,forceFocusInsideTrap:((n=l==null?void 0:l.forceFocusInsideTrap)!==null&&n!==void 0?n:B)&&!p,firstFocusableSelector:(l==null?void 0:l.firstFocusableSelector)||S,focusPreviouslyFocusedInnerElement:(d=l==null?void 0:l.focusPreviouslyFocusedInnerElement)!==null&&d!==void 0?d:!0,onBlur:c.isInKeyboardMoveMode?Nt:void 0}),b&&c.isInKeyboardMoveMode&&i.createElement("div",{className:Y.keyboardMoveIconContainer},b.keyboardMoveIconProps?i.createElement($e,h({},b.keyboardMoveIconProps)):i.createElement($e,{iconName:"move",className:Y.keyboardMoveIcon})),i.createElement("div",{ref:bt,className:Y.scrollableContent,"data-is-scrollable":!0},b&&je&&i.createElement(b.menu,{items:[{key:"move",text:b.moveMenuItemText,onClick:St},{key:"close",text:b.closeMenuItemText,onClick:We}],onDismiss:q,alignTargetEdge:!0,coverTarget:!0,directionalHint:Vt.topLeftEdge,directionalHintFixed:!0,shouldFocusOnMount:!0,target:c.scrollableContent}),D));return ve&&ut>=(M||Xt.small)&&i.createElement(Jt,h({ref:Ie},yt),i.createElement(Qt,h({role:gt?"alertdialog":"dialog",ariaLabelledBy:H,ariaDescribedBy:Q,onDismiss:j,shouldRestoreFocus:!_,enableAriaHiddenSiblings:me,"aria-modal":!p},le),i.createElement("div",{className:Y.root,role:p?void 0:"document"},!p&&i.createElement(No,h({"aria-hidden":!0,isDarkThemed:J,onClick:F?void 0:j,allowTouchBodyScroll:v},$)),b?i.createElement(Fo,{handleSelector:b.dragHandleSelector||"#".concat(Me),preventDragSelector:"button",onStart:Ct,onDragChange:Tt,onStop:Dt,position:He},Ue):Ue)))||null});nt.displayName="Modal";var st=ie(nt,xo,void 0,{scope:"Modal",fields:["theme","styles","enableAriaHiddenSiblings"]});st.displayName="Modal";var Eo=se(),ko=function(a){re(o,a);function o(t){var e=a.call(this,t)||this;return Ne(e),e}return o.prototype.render=function(){var t=this.props,e=t.className,s=t.styles,n=t.theme;return this._classNames=Eo(s,{theme:n,className:e}),i.createElement("div",{className:this._classNames.actions},i.createElement("div",{className:this._classNames.actionsRight},this._renderChildrenAsActions()))},o.prototype._renderChildrenAsActions=function(){var t=this;return i.Children.map(this.props.children,function(e){return e?i.createElement("span",{className:t._classNames.action},e):null})},o}(i.Component),Oo={actions:"ms-Dialog-actions",action:"ms-Dialog-action",actionsRight:"ms-Dialog-actionsRight"},Bo=function(a){var o=a.className,t=a.theme,e=ne(Oo,t);return{actions:[e.actions,{position:"relative",width:"100%",minHeight:"24px",lineHeight:"24px",margin:"16px 0 0",fontSize:"0",selectors:{".ms-Button":{lineHeight:"normal",verticalAlign:"middle"}}},o],action:[e.action,{margin:"0 4px"}],actionsRight:[e.actionsRight,{alignItems:"center",display:"flex",fontSize:"0",justifyContent:"flex-end",marginRight:"-4px"}]}},_e=ie(ko,Bo,void 0,{scope:"DialogFooter"});_e.displayName="DialogFooter";var Ro=se(),Ho=i.createElement(_e,null).type,Lo=function(a){re(o,a);function o(t){var e=a.call(this,t)||this;return Ne(e),e}return o.prototype.render=function(){var t=this.props,e=t.showCloseButton,s=t.className,n=t.closeButtonAriaLabel,d=t.onDismiss,r=t.subTextId,v=t.subText,m=t.titleProps,D=m===void 0?{}:m,g=t.titleId,y=t.title,N=t.type,S=t.styles,l=t.theme,B=t.draggableHeaderClassName,C=Ro(S,{theme:l,className:s,isLargeHeader:N===A.largeHeader,isClose:N===A.close,draggableHeaderClassName:B}),_=this._groupChildren(),F;return v&&(F=i.createElement("p",{className:C.subText,id:r},v)),i.createElement("div",{className:C.content},i.createElement("div",{className:C.header},i.createElement("div",h({id:g,role:"heading","aria-level":1},D,{className:Qe(C.title,D.className)}),y),i.createElement("div",{className:C.topButton},this.props.topButtonsProps.map(function(w,R){return i.createElement(Ge,h({key:w.uniqueId||R},w))}),(N===A.close||e&&N!==A.largeHeader)&&i.createElement(Ge,{className:C.button,iconProps:{iconName:"Cancel"},ariaLabel:n,onClick:d}))),i.createElement("div",{className:C.inner},i.createElement("div",{className:C.innerContent},F,_.contents),_.footers))},o.prototype._groupChildren=function(){var t={footers:[],contents:[]};return i.Children.map(this.props.children,function(e){typeof e=="object"&&e!==null&&e.type===Ho?t.footers.push(e):t.contents.push(e)}),t},o.defaultProps={showCloseButton:!1,className:"",topButtonsProps:[],closeButtonAriaLabel:"Close"},o=et([tt],o),o}(i.Component),Ao={contentLgHeader:"ms-Dialog-lgHeader",close:"ms-Dialog--close",subText:"ms-Dialog-subText",header:"ms-Dialog-header",headerLg:"ms-Dialog--lgHeader",button:"ms-Dialog-button ms-Dialog-button--close",inner:"ms-Dialog-inner",content:"ms-Dialog-content",title:"ms-Dialog-title"},jo=function(a){var o,t,e,s=a.className,n=a.theme,d=a.isLargeHeader,r=a.isClose,v=a.hidden,m=a.isMultiline,D=a.draggableHeaderClassName,g=n.palette,y=n.fonts,N=n.effects,S=n.semanticColors,l=ne(Ao,n);return{content:[d&&[l.contentLgHeader,{borderTop:"4px solid ".concat(g.themePrimary)}],r&&l.close,{flexGrow:1,overflowY:"hidden"},s],subText:[l.subText,y.medium,{margin:"0 0 24px 0",color:S.bodySubtext,lineHeight:"1.5",wordWrap:"break-word",fontWeight:eo.regular}],header:[l.header,{position:"relative",width:"100%",boxSizing:"border-box"},r&&l.close,D&&[D,{cursor:"move"}]],button:[l.button,v&&{selectors:{".ms-Icon.ms-Icon--Cancel":{color:S.buttonText,fontSize:to.medium}}}],inner:[l.inner,{padding:"0 24px 24px",selectors:(o={},o["@media (min-width: ".concat(he,"px) and (max-width: ").concat(ye,"px)")]={padding:"0 16px 16px"},o)}],innerContent:[l.content,{position:"relative",width:"100%"}],title:[l.title,y.xLarge,{color:S.bodyText,margin:"0",minHeight:y.xLarge.fontSize,padding:"16px 46px 20px 24px",lineHeight:"normal",selectors:(t={},t["@media (min-width: ".concat(he,"px) and (max-width: ").concat(ye,"px)")]={padding:"16px 46px 16px 16px"},t)},d&&{color:S.menuHeader},m&&{fontSize:y.xxLarge.fontSize}],topButton:[{display:"flex",flexDirection:"row",flexWrap:"nowrap",position:"absolute",top:"0",right:"0",padding:"15px 15px 0 0",selectors:(e={"> *":{flex:"0 0 auto"},".ms-Dialog-button":{color:S.buttonText},".ms-Dialog-button:hover":{color:S.buttonTextHovered,borderRadius:N.roundedCorner2}},e["@media (min-width: ".concat(he,"px) and (max-width: ").concat(ye,"px)")]={padding:"15px 8px 0 0"},e)}]}},rt=ie(Lo,jo,void 0,{scope:"DialogContent"});rt.displayName="DialogContent";var Ko=se(),Wo={isDarkOverlay:!1,isBlocking:!1,className:"",containerClassName:"",topOffsetFixed:!1,enableAriaHiddenSiblings:!0},Uo={type:A.normal,className:"",topButtonsProps:[]},zo=function(a){re(o,a);function o(t){var e=a.call(this,t)||this;return e._getSubTextId=function(){var s=e.props,n=s.ariaDescribedById,d=s.modalProps,r=s.dialogContentProps,v=s.subText,m=d&&d.subtitleAriaId||n;return m||(m=(r&&r.subText||v)&&e._defaultSubTextId),m},e._getTitleTextId=function(){var s=e.props,n=s.ariaLabelledById,d=s.modalProps,r=s.dialogContentProps,v=s.title,m=d&&d.titleAriaId||n;return m||(m=(r&&r.title||v)&&e._defaultTitleTextId),m},e._id=oo("Dialog"),e._defaultTitleTextId=e._id+"-title",e._defaultSubTextId=e._id+"-subText",e}return o.prototype.render=function(){var t,e,s,n=this.props,d=n.className,r=n.containerClassName,v=n.contentClassName,m=n.elementToFocusOnDismiss,D=n.firstFocusableSelector,g=n.forceFocusInsideTrap,y=n.styles,N=n.hidden,S=n.disableRestoreFocus,l=S===void 0?n.ignoreExternalFocusing:S,B=n.isBlocking,C=n.isClickableOutsideFocusTrap,_=n.isDarkOverlay,F=n.isOpen,w=F===void 0?!N:F,R=n.onDismiss,J=n.onDismissed,j=n.onLayerDidMount,I=n.responsiveMode,$=n.subText,P=n.theme,H=n.title,Z=n.topButtonsProps,Q=n.type,ee=n.minWidth,G=n.maxWidth,M=n.modalProps,u=h({onLayerDidMount:j},M==null?void 0:M.layerProps),p,b;M!=null&&M.dragOptions&&!(!((t=M.dragOptions)===null||t===void 0)&&t.dragHandleSelector)&&(b=h({},M.dragOptions),p="ms-Dialog-draggable-header",b.dragHandleSelector=".".concat(p));var L=h(h(h(h({},Wo),{elementToFocusOnDismiss:m,firstFocusableSelector:D,forceFocusInsideTrap:g,disableRestoreFocus:l,isClickableOutsideFocusTrap:C,responsiveMode:I,className:d,containerClassName:r,isBlocking:B,isDarkOverlay:_,onDismissed:J}),M),{dragOptions:b,layerProps:u,isOpen:w}),me=h(h(h({className:v,subText:$,title:H,topButtonsProps:Z,type:Q},Uo),n.dialogContentProps),{draggableHeaderClassName:p,titleProps:h({id:((e=n.dialogContentProps)===null||e===void 0?void 0:e.titleId)||this._defaultTitleTextId},(s=n.dialogContentProps)===null||s===void 0?void 0:s.titleProps)}),le=Ko(y,{theme:P,className:L.className,containerClassName:L.containerClassName,hidden:N,dialogDefaultMinWidth:ee,dialogDefaultMaxWidth:G});return i.createElement(st,h({},L,{className:le.root,containerClassName:le.main,onDismiss:R||L.onDismiss,subtitleAriaId:this._getSubTextId(),titleAriaId:this._getTitleTextId()}),i.createElement(rt,h({subTextId:this._defaultSubTextId,showCloseButton:L.isBlocking,onDismiss:R},me),n.children))},o.defaultProps={hidden:!0},o=et([tt],o),o}(i.Component),$o={root:"ms-Dialog"},Zo=function(a){var o,t=a.className,e=a.containerClassName,s=a.dialogDefaultMinWidth,n=s===void 0?"288px":s,d=a.dialogDefaultMaxWidth,r=d===void 0?"340px":d,v=a.hidden,m=a.theme,D=ne($o,m);return{root:[D.root,m.fonts.medium,t],main:[{width:n,outline:"3px solid transparent",selectors:(o={},o["@media (min-width: ".concat(ao,"px)")]={width:"auto",maxWidth:r,minWidth:n},o)},!v&&{display:"flex"},e]}},it=ie(zo,Zo,void 0,{scope:"Dialog"});it.displayName="Dialog";const Go=()=>{const a=window.navigator.language==="en",[o,t]=i.useState(!1),[e,s]=i.useState(!0),n=async()=>{const v=Object.fromEntries(new URLSearchParams(location.search));await Ze("FP",v),s(!1)},d=async()=>{var D;const v=Object.fromEntries(new URLSearchParams(location.search));o&&await Ce(de.Allow,v.url),await uo(de.Block,v.url);const m=(D=await chrome.tabs.getCurrent())==null?void 0:D.id;await Ce(de.Tmp,`${v.url}@${Date.now()+3e5}@${m}`),history.go(-1)},r=()=>chrome.runtime.sendMessage({type:"close"});return i.useEffect(()=>{const v=Object.fromEntries(new URLSearchParams(location.search));io().then(async m=>{m&&await Ze("Detect",v)}),lo().then(m=>{m&&Ce(de.Block,v.url).then()}),co().then(m=>t(m))},[]),T.jsx(T.Fragment,{children:T.jsxs(no,{style:{minHeight:"100vh",display:"grid",justifyItems:"center",backgroundColor:"#B3261E"},children:[T.jsxs(be,{tokens:{childrenGap:20},style:{paddingTop:"200px"},children:[T.jsxs(be,{horizontal:!0,children:[T.jsx("img",{src:"/warning.svg",alt:"WarnignIcon"}),T.jsx("img",{src:"/phishing.svg",alt:"PhishingIcon"})]}),T.jsx(xe,{style:{color:"#e9e9e9",fontSize:"2.5em"},children:a?"Phishing site detected":"フィッシングサイトを検出しました"}),T.jsxs(xe,{style:{color:"#e9e9e9",fontSize:"1.25em"},children:[T.jsx("b",{children:new URL(location.href).searchParams.get("url")}),a?" might steal your personally identifiable information.":" は機密情報を盗み取る疑いがあります"]}),T.jsxs(xe,{style:{color:"#e9e9e9",fontSize:"1.25em"},children:["検出時間：",T.jsx("b",{children:new URL(location.href).searchParams.get("time")})," ms"]}),T.jsxs(be,{horizontal:!0,horizontalAlign:"center",style:{paddingTop:20},tokens:{childrenGap:20},children:[T.jsx(Te,{onClick:n,children:a?"Report a false positive":"誤検出を報告"}),T.jsx(Te,{onClick:d,children:a?"Access this page":"ページにアクセスする"}),T.jsx(Te,{onClick:r,children:a?"Close this page":"ページを閉じる"})]})]}),T.jsx(it,{hidden:e,dialogContentProps:{type:A.normal,title:a?"False positive reported":"誤検出を報告しました",subText:a?"Thank you for your cooperation":"ご協力ありがとうございました"},modalProps:{isBlocking:!0,styles:{main:{width:450}}},children:T.jsx(_e,{children:T.jsx(mo,{onClick:d,text:a?"Back to page":"ページに戻る"})})})]})})};po();so.createRoot(document.getElementById("root")).render(T.jsx(ro.StrictMode,{children:T.jsx(Go,{})}));
